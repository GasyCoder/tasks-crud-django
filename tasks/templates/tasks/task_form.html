{% extends "tasks/base.html" %}
{% block title %}{% if mode == "create" %}Créer une tâche{% else %}Modifier{% endif %}{% endblock %}

{% block content %}
  <!-- Breadcrumb -->
  <div class="mb-6">
    <nav class="flex items-center space-x-2 text-sm">
      <a href="{% url 'tasks:list' %}" class="text-purple-300 hover:text-white transition-colors">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
        </svg>
      </a>
      <svg class="w-4 h-4 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
      </svg>
      <span class="text-purple-200">{% if mode == "create" %}Nouvelle tâche{% else %}Modification{% endif %}</span>
    </nav>
  </div>

  <div class="max-w-3xl">
    <!-- Page Header -->
    <div class="mb-8">
      <h2 class="text-3xl sm:text-4xl font-bold text-white mb-2 bg-gradient-to-r from-purple-200 to-blue-200 bg-clip-text text-transparent">
        {% if mode == "create" %}
          Créer une nouvelle tâche
        {% else %}
          Modifier : {{ task.title }}
        {% endif %}
      </h2>
      <p class="text-purple-200/70">
        {% if mode == "create" %}
          Remplissez le formulaire ci-dessous pour créer une nouvelle tâche
        {% else %}
          Mettez à jour les informations de votre tâche
        {% endif %}
      </p>
    </div>

    <!-- Form -->
    <form method="post" class="glass-dark rounded-2xl p-8 border border-white/10 shadow-2xl">
      {% csrf_token %}

      <!-- Title Field -->
      <div class="mb-6">
        <label for="{{ form.title.id_for_label }}" class="block text-sm font-semibold text-purple-100 mb-2">
          <div class="flex items-center">
            <svg class="w-4 h-4 mr-2 text-purple-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path>
            </svg>
            Titre de la tâche
            <span class="text-red-400 ml-1">*</span>
          </div>
        </label>
        <input 
          type="text"
          name="{{ form.title.name }}"
          id="{{ form.title.id_for_label }}"
          value="{{ form.title.value|default:'' }}"
          required
          class="w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-purple-300/50 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-300"
          placeholder="Ex: Terminer le rapport mensuel"
        >
        {% if form.title.errors %}
          <div class="mt-2 flex items-center text-sm text-red-400">
            <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
            </svg>
            {{ form.title.errors|striptags }}
          </div>
        {% endif %}
      </div>

      <!-- Description Field -->
      <div class="mb-6">
        <label for="{{ form.description.id_for_label }}" class="block text-sm font-semibold text-purple-100 mb-2">
          <div class="flex items-center">
            <svg class="w-4 h-4 mr-2 text-purple-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7"></path>
            </svg>
            Description
          </div>
        </label>
        <textarea 
          name="{{ form.description.name }}"
          id="{{ form.description.id_for_label }}"
          rows="6"
          class="w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-purple-300/50 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-300 resize-y"
          placeholder="Décrivez votre tâche en détail..."
        >{{ form.description.value|default:'' }}</textarea>
        {% if form.description.errors %}
          <div class="mt-2 flex items-center text-sm text-red-400">
            <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
            </svg>
            {{ form.description.errors|striptags }}
          </div>
        {% endif %}
      </div>

      <!-- Is Done Field -->
      <div class="mb-8">
        <label class="flex items-center cursor-pointer group">
          <div class="relative">
            <input 
              type="checkbox"
              name="{{ form.is_done.name }}"
              id="{{ form.is_done.id_for_label }}"
              {% if form.is_done.value %}checked{% endif %}
              class="sr-only peer"
            >
            <div class="w-14 h-7 bg-white/10 rounded-full peer peer-checked:bg-gradient-to-r peer-checked:from-green-500 peer-checked:to-emerald-500 transition-all duration-300 border border-white/20 peer-checked:border-green-400"></div>
            <div class="absolute left-1 top-1 bg-white w-5 h-5 rounded-full transition-all duration-300 peer-checked:translate-x-7 shadow-lg"></div>
          </div>
          <div class="ml-4">
            <span class="text-sm font-semibold text-purple-100 group-hover:text-white transition-colors">
              Marquer comme terminé
            </span>
            <p class="text-xs text-purple-300/60">La tâche sera marquée comme complétée</p>
          </div>
        </label>
        {% if form.is_done.errors %}
          <div class="mt-2 flex items-center text-sm text-red-400">
            <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
            </svg>
            {{ form.is_done.errors|striptags }}
          </div>
        {% endif %}
      </div>

      <!-- Action Buttons -->
      <div class="flex flex-col sm:flex-row gap-4 pt-6 border-t border-white/10">
        <button 
          type="submit" 
          class="flex-1 inline-flex items-center justify-center px-8 py-4 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-500 hover:to-blue-500 text-white font-semibold rounded-xl transition-all duration-300 transform hover:scale-105 hover:shadow-2xl hover:shadow-purple-500/50 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 focus:ring-offset-purple-900"
        >
          <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
          </svg>
          {% if mode == "create" %}Créer la tâche{% else %}Enregistrer les modifications{% endif %}
        </button>
        <a 
          href="{% url 'tasks:list' %}" 
          class="flex-1 inline-flex items-center justify-center px-8 py-4 bg-white/5 hover:bg-white/10 text-purple-200 hover:text-white border border-white/10 hover:border-purple-500/50 font-semibold rounded-xl transition-all duration-300"
        >
          <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
          Annuler
        </a>
      </div>
    </form>
  </div>
{% endblock %}
